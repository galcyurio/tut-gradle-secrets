import groovy.swing.SwingBuilder

import javax.swing.JPasswordField

task initSecrets4 doLast {
    SwingBuilder swing = new SwingBuilder()
    swing.dialog(
            modal: true,
            title: "Password",
            resizable: false,
            alwaysOnTop: true,
            locationRelativeTo: null,
            pack: true,
            show: true,
    ) {
        swing.vbox {
            swing.label(text: "Type password: ")
            JPasswordField input = swing.passwordField()
            swing.button(
                    defaultButton: true,
                    text: 'OK',
                    actionPerformed: {
                        ext.password = input.password
                        dispose()
                    })
        }
    }
}

/**
 * ./gradlew clean build4Production2 -P password=123456
 */
task build4Production4 {
    dependsOn initSecrets4

    dependsOn build
    build.mustRunAfter initSecrets4

    doLast {
        def password = initSecrets4.password
        // TODO: Do something
    }
}
